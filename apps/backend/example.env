##############################################
# 🚀 Chengtong Vision Backend Environment
# Copy this file → .env.development or .env.production
##############################################

##############################################
# 🌐 Backend Base
##############################################

# Node 环境：development / production / test
NODE_ENV="development"

# Express 服务端口（默认 8096）
PORT=8096


##############################################
# 🗄 PostgreSQL / Supabase Database
##############################################

# 主数据库连接（必须）
DATABASE_URL="postgresql://postgres:password@127.0.0.1:5432/postgres?schema=public"

# Supabase 本地 / 生产 URL
SUPABASE_URL="http://127.0.0.1:8000"

# 匿名 key（查询用）– 生产环境请勿暴露！
SUPABASE_ANON_KEY="supabase-anon-key"

# 服务级 key（如需要服务端增删改）– 建议只在生产环境配置
SUPABASE_SERVICE_KEY="supabase-service-role-key"


##############################################
# 🔥 MQTT Broker（现场采集盒子）
##############################################

# 本地开发一般不连真实 MQTT
MQTT_BROKER_URL="mqtt://127.0.0.1"

# 真实环境（示例）
# MQTT_BROKER_URL="mqtt://10.5.xx.xx"

MQTT_USERNAME=""
MQTT_PASSWORD=""

# 主题前缀
MQTT_HEARTBEAT_TOPIC="chengtong/heartbeat"
MQTT_REALDATA_TOPIC="chengtong/realdata"


##############################################
# 🛠 TBM Engine
##############################################

# 历史窗口（毫秒）
TBM_HISTORY_WINDOW="600000"   # 10 分钟

# Spike 判定阈值（绝对差值 > X）
TBM_SPIKE_DELTA="100"

# 超限合并去重窗口（毫秒）
TBM_EVENT_DEDUP_WINDOW="30000"

# 是否启用通知模块（on/off）
TBM_NOTIFY_ENABLED="on"


##############################################
# 📡 Notification Service（短信 / 微信等）
##############################################

# 企业微信机器人 Webhook
WECHAT_WEBHOOK_URL=""

# 短信签名 / Key（可选）
SMS_ACCESS_KEY=""
SMS_ACCESS_SECRET=""

# 钉钉机器人（可选）
DINGTALK_WEBHOOK_URL=""


##############################################
# 🧵 Concurrency / Workers
##############################################

# 阀值刷新并发数
THRESHOLD_REFRESH_CONCURRENCY=6

# 事件入库 worker 并发数
EVENT_WORKERS=4


##############################################
# 🧭 Optional: Redis / Cache（可启用）
##############################################

REDIS_URL=""
REDIS_PASSWORD=""


##############################################
# 📈 Logging
##############################################

# error, warn, info, debug, trace
LOG_LEVEL="info"


##############################################
# 🛡 Security
##############################################

# JWT / Session
JWT_SECRET="replace-me-for-production"

# 跨服务调用私钥（内部微服务）
INTERNAL_SERVICE_KEY=""
